import{d,k as C,l as U,u as O,o as f,e as v,a,b as r,w as _,i as b,t as l,g as o,n as m,x as c,y as h,f as H,N as y,T as Y,O as B,p as P}from"./app.66348164.js";import{_ as S}from"./Label.e6f9ab74.js";import{_ as R}from"./ContactSelect.1a42e862.js";import{_ as z}from"./ProjectSelect.9e1c692f.js";import{_ as E}from"./Button.e2e93ccc.js";import{_ as q}from"./Input.87ee8fd0.js";const A=["onSubmit"],G={class:"my-2 flex-auto basis-0"},J={key:0,class:"my-2 flex-auto basis-0"},K=b(" / "),L={class:"my-2 flex-auto basis-0"},Q={class:"block font-medium text-sm text-gray-700 mb-1"},W=b(" / "),X={key:1,class:"grid grid-cols-2 gep-x-3"},Z={class:"relative"},ee=a("p",{class:"absolute top-0 ml-1 text-xxs"},"From:",-1),te={class:"relative"},oe=a("p",{class:"absolute top-0 ml-1 text-xxs"},"To:",-1),se={class:"my-2 flex-auto basis-0"},ae=a("span",{class:"text-red-500"},"*",-1),ne={class:"relative overflow-hidden"},re=["textContent"],le={class:"col-span-4 flex justify-end mt-5 w-full"},fe={__name:"TimeTrackForm",props:{attach:Object},emits:["saved"],setup(x,{emit:D}){var V,j;const k=x,i=d("contact"),u=d("duration"),g=d(),w=d(),p=C(()=>U().props.value.errors);C(()=>Object.keys(p.value).length>0);const $=d(),T=d(),s=O({timetrackable_type:(V=k.attach)==null?void 0:V.classname,timetrackable_id:(j=k.attach)==null?void 0:j.id,duration:"",note:"",created_at:moment().format("YYYY-MM-DDTHH:mm")}),M=()=>{s.post(route("timetrack.store"),{onSuccess:()=>{D("saved"),s.reset(),i.value=="contact"?$.value.reset():T.value.reset()}})},F=()=>{var n=moment(g.value,"HH:mm"),e=moment(w.value,"HH:mm"),t=moment.duration(e.diff(n)),I=parseInt(t.asHours())<10?"0"+parseInt(t.asHours()):parseInt(t.asHours()),N=parseInt(t.asMinutes())%60<10?"0"+parseInt(t.asMinutes())%60:parseInt(t.asMinutes())%60;s.duration=I+":"+N,u.value="duration"};return(n,e)=>(f(),v("form",{onSubmit:P(M,["prevent"])},[a("div",B({class:"flex space-x-5 w-full"},n.$attrs),[a("div",G,[r(S,{class:"mb-1"},{default:_(()=>[b(l(n.__("Date")),1)]),_:1}),r(q,{id:"created_at",name:"created_at",modelValue:o(s).created_at,"onUpdate:modelValue":e[0]||(e[0]=t=>o(s).created_at=t),type:"datetime-local",class:"border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full"},null,8,["modelValue"])]),k.attach!==Object?(f(),v("div",J,[r(S,{class:"mb-1"},{default:_(()=>[a("span",{onClick:e[1]||(e[1]=t=>i.value="contact"),class:m(["underline cursor-pointer",i.value=="contact"?"text-orange-500":""])},l(n.__("Select Customer")),3),K,a("span",{onClick:e[2]||(e[2]=t=>i.value="project"),class:m(["underline cursor-pointer",i.value=="project"?"text-orange-500":""])},l(n.__("Select Project")),3)]),_:1}),c(r(R,{ref_key:"contactSelect",ref:$,contact:x.attach,form:o(s),onRemove:e[3]||(e[3]=t=>o(s).contact_id=null),onSet:e[4]||(e[4]=t=>{o(s).timetrackable_type=t.classname,o(s).timetrackable_id=t.id}),address:!1},null,8,["contact","form"]),[[h,i.value==="contact"]]),c(r(z,{ref_key:"projectSelect",ref:T,contact:x.attach,form:o(s),onRemove:e[5]||(e[5]=t=>o(s).contact_id=null),onSet:e[6]||(e[6]=t=>{o(s).timetrackable_type=t.classname,o(s).timetrackable_id=t.id}),address:!1},null,8,["contact","form"]),[[h,i.value=="project"]])])):H("",!0),a("div",L,[a("label",Q,[a("span",{class:m(["cursor-pointer",u.value=="duration"?"text-orange-500 underline":""]),onClick:e[7]||(e[7]=t=>u.value="duration")},l(n.__("Duration")),3),W,a("span",{class:m(["cursor-pointer",u.value!="duration"?"text-orange-500 underline":""]),onClick:e[8]||(e[8]=t=>u.value="span")},l(n.__("From - To")),3)]),u.value=="duration"?c((f(),v("input",{key:0,id:"duration",type:"time","onUpdate:modelValue":e[9]||(e[9]=t=>o(s).duration=t),class:"w-full border-gray-300"},null,512)),[[y,o(s).duration]]):(f(),v("div",X,[a("div",Z,[c(a("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":e[10]||(e[10]=t=>g.value=t)},null,512),[[y,g.value]]),ee]),a("div",te,[c(a("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":e[11]||(e[11]=t=>w.value=t),onFocusout:F},null,544),[[y,w.value]]),oe])]))]),a("div",se,[r(S,{for:"note"},{default:_(()=>[b(l(n.__("Note")),1),ae]),_:1}),a("div",ne,[c(a("textarea",{rows:"1",id:"name","onUpdate:modelValue":e[12]||(e[12]=t=>o(s).note=t),class:m(["border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full",o(p).note?"border-2 border-red-500":""]),onFocus:e[13]||(e[13]=t=>delete o(p).note)},null,34),[[y,o(s).note]]),r(Y,{name:"error"},{default:_(()=>[o(p).note?(f(),v("p",{key:0,class:"absolute left-0 bottom-0 text-red-600 text-xxs ml-3 line-clamp-1 hover:line-clamp-3",textContent:l(o(p).note)},null,8,re)):H("",!0)]),_:1})])])],16),a("div",le,[r(E,{class:m({"opacity-25":o(s).processing}),disabled:o(s).processing},{default:_(()=>[b(l(n.__("save")),1)]),_:1},8,["class","disabled"])])],40,A))}};export{fe as _};
