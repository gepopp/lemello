import{d as m,K as P,o as v,e as p,a as o,b,g as a,M as H,x as g,F as Y,h as K,n as y,t as u,f as D,k as I,l as z,u as L,w as $,i as C,y as N,N as T,T as R,O as E,p as q}from"./app.902c1631.js";import{_ as F}from"./Label.e87d20e0.js";import{_ as A}from"./ContactSelect.6afe4676.js";import{_ as O}from"./Input.0ba70f7a.js";import{_ as G}from"./Button.03a0c649.js";const J={key:0},Q={class:"relative"},W={key:0,class:"absolute bg-white shadow-2xl border border-gray-100 w-full p-2 z-50"},X=["onClick","onMouseover"],Z=["textContent"],ee=["textContent"],te={key:1},oe={class:"border border-gray-400 p-2 bg-white flex justify-between"},se={class:"leading-tight"},ae=["textContent"],ne=["textContent"],le=o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 w-6"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1),re=[le],ie={__name:"ProjectSelect",props:{project:Object,filter:{type:Object,default:{}}},emits:["remove","set"],setup(k,{expose:V,emit:h}){const d=k,f=m(""),c=m(d.project),r=m([]),l=m(0),j=_.debounce(x=>{axios.get(route("project.search",{search:x.target.value,...d.filter})).then(i=>{console.log(i.data),r.value=i.data})},500),S=()=>{w(),h("remove")},s=x=>{c.value=x,f.value="",r.value=[],h("set",x)},w=()=>{c.value=null,f.value="",r.value=[]};return V({attached:c,reset:w}),(x,i)=>{const M=P("click-outside");return c.value?(v(),p("div",te,[o("div",oe,[o("div",se,[o("p",{class:"text-sm",textContent:u(c.value.name)},null,8,ae),o("p",{class:"text-xs",textContent:u(c.value.contact.name)},null,8,ne)]),o("div",{class:"text-red-500 cursor-pointer flex items-center",onClick:S},re)])])):(v(),p("div",J,[o("div",Q,[b(O,{id:"search",onInput:a(j),class:"mt-1 block w-full",type:"text",onKeydown:[i[0]||(i[0]=H(n=>l.value<r.value.length-1?l.value++:l.value=0,["down"])),i[1]||(i[1]=H(n=>l.value>0?l.value--:l.value=r.value.length-1,["up"])),i[2]||(i[2]=H(n=>s(r.value[l.value]),["enter"]))]},null,8,["onInput"]),r.value.length?g((v(),p("div",W,[(v(!0),p(Y,null,K(r.value,(n,e)=>(v(),p("div",{onClick:t=>s(n),onMouseover:t=>l.value=e,class:y(["border border-gray-400 p-2 cursor-pointer mb-2",l.value==e?"bg-gray-200 border-2 border-orange-600":""])},[o("p",{textContent:u(n.name)},null,8,Z),o("p",{class:"text-xs font-thin",textContent:u(n.contact.name)},null,8,ee)],42,X))),256))])),[[M,w]]):D("",!0)])]))}}},ue=["onSubmit"],de={class:"my-2 flex-auto basis-0"},ce={key:0,class:"my-2 flex-auto basis-0"},me=C(" / "),ve={class:"my-2 flex-auto basis-0"},pe={class:"block font-medium text-sm text-gray-700 mb-1"},_e=C(" / "),fe={key:1,class:"grid grid-cols-2 gep-x-3"},be={class:"relative"},xe=o("p",{class:"absolute top-0 ml-1 text-xxs"},"From:",-1),ge={class:"relative"},ye=o("p",{class:"absolute top-0 ml-1 text-xxs"},"To:",-1),he={class:"my-2 flex-auto basis-0"},ke=o("span",{class:"text-red-500"},"*",-1),we={class:"relative overflow-hidden"},$e=["textContent"],Ce={class:"col-span-4 flex justify-end mt-5 w-full"},He={__name:"TimeTrackForm",props:{attach:Object},emits:["saved"],setup(k,{emit:V}){var i,M;const h=k,d=m("contact"),f=m("duration"),c=m(),r=m(),l=I(()=>z().props.value.errors);I(()=>Object.keys(l.value).length>0);const j=m(),S=m(),s=L({timetrackable_type:(i=h.attach)==null?void 0:i.classname,timetrackable_id:(M=h.attach)==null?void 0:M.id,duration:"",note:"",created_at:moment().format("YYYY-MM-DDTHH:mm")}),w=()=>{s.post(route("timetrack.store"),{onSuccess:()=>{V("saved"),s.reset(),d.value=="contact"?j.value.reset():S.value.reset()}})},x=()=>{var n=moment(c.value,"HH:mm"),e=moment(r.value,"HH:mm"),t=moment.duration(e.diff(n)),U=parseInt(t.asHours())<10?"0"+parseInt(t.asHours()):parseInt(t.asHours()),B=parseInt(t.asMinutes())%60<10?"0"+parseInt(t.asMinutes())%60:parseInt(t.asMinutes())%60;s.duration=U+":"+B,f.value="duration"};return(n,e)=>(v(),p("form",{onSubmit:q(w,["prevent"])},[o("div",E({class:"flex space-x-5 w-full"},n.$attrs),[o("div",de,[b(F,{class:"mb-1"},{default:$(()=>[C(u(n.__("Date")),1)]),_:1}),b(O,{id:"created_at",name:"created_at",modelValue:a(s).created_at,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).created_at=t),type:"datetime-local",class:"border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full"},null,8,["modelValue"])]),h.attach!==Object?(v(),p("div",ce,[b(F,{class:"mb-1"},{default:$(()=>[o("span",{onClick:e[1]||(e[1]=t=>d.value="contact"),class:y(["underline cursor-pointer",d.value=="contact"?"text-orange-500":""])},u(n.__("Select Customer")),3),me,o("span",{onClick:e[2]||(e[2]=t=>d.value="project"),class:y(["underline cursor-pointer",d.value=="project"?"text-orange-500":""])},u(n.__("Select Project")),3)]),_:1}),g(b(A,{ref_key:"contactSelect",ref:j,contact:k.attach,form:a(s),onRemove:e[3]||(e[3]=t=>a(s).contact_id=null),onSet:e[4]||(e[4]=t=>{a(s).timetrackable_type=t.classname,a(s).timetrackable_id=t.id}),address:!1},null,8,["contact","form"]),[[N,d.value==="contact"]]),g(b(ie,{ref_key:"projectSelect",ref:S,contact:k.attach,form:a(s),onRemove:e[5]||(e[5]=t=>a(s).contact_id=null),onSet:e[6]||(e[6]=t=>{a(s).timetrackable_type=t.classname,a(s).timetrackable_id=t.id}),address:!1},null,8,["contact","form"]),[[N,d.value=="project"]])])):D("",!0),o("div",ve,[o("label",pe,[o("span",{class:y(["cursor-pointer",f.value=="duration"?"text-orange-500 underline":""]),onClick:e[7]||(e[7]=t=>f.value="duration")},u(n.__("Duration")),3),_e,o("span",{class:y(["cursor-pointer",f.value!="duration"?"text-orange-500 underline":""]),onClick:e[8]||(e[8]=t=>f.value="span")},u(n.__("From - To")),3)]),f.value=="duration"?g((v(),p("input",{key:0,id:"duration",type:"time","onUpdate:modelValue":e[9]||(e[9]=t=>a(s).duration=t),class:"w-full border-gray-300"},null,512)),[[T,a(s).duration]]):(v(),p("div",fe,[o("div",be,[g(o("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":e[10]||(e[10]=t=>c.value=t)},null,512),[[T,c.value]]),xe]),o("div",ge,[g(o("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":e[11]||(e[11]=t=>r.value=t),onFocusout:x},null,544),[[T,r.value]]),ye])]))]),o("div",he,[b(F,{for:"note"},{default:$(()=>[C(u(n.__("Note")),1),ke]),_:1}),o("div",we,[g(o("textarea",{rows:"1",id:"name","onUpdate:modelValue":e[12]||(e[12]=t=>a(s).note=t),class:y(["border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full",a(l).note?"border-2 border-red-500":""]),onFocus:e[13]||(e[13]=t=>delete a(l).note)},null,34),[[T,a(s).note]]),b(R,{name:"error"},{default:$(()=>[a(l).note?(v(),p("p",{key:0,class:"absolute left-0 bottom-0 text-red-600 text-xxs ml-3 line-clamp-1 hover:line-clamp-3",textContent:u(a(l).note)},null,8,$e)):D("",!0)]),_:1})])])],16),o("div",Ce,[b(G,{class:y({"opacity-25":a(s).processing}),disabled:a(s).processing},{default:$(()=>[C(u(n.__("save")),1)]),_:1},8,["class","disabled"])])],40,ue))}};export{He as _};
