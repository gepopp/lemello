import{d as v,k as j,u as N,o as b,c as F,w as d,a as o,t as n,b as l,i as _,g as a,n as c,x as p,y as C,N as k,e as w,f as U,T as B,p as E,l as Y}from"./app.9eed93a5.js";import{_ as R}from"./AppLayout.343e5fd7.js";import{_ as S}from"./Label.3ba238b5.js";import{_ as O}from"./ContactSelect.6fdedf85.js";import{_ as P}from"./ProjectSelect.e38f36a4.js";import{_ as z}from"./Button.693dd352.js";import{_ as A}from"./Input.d6bf1a0f.js";import"./_plugin-vue_export-helper.cdc0426e.js";const q={class:"font-semibold text-xl text-gray-800 leading-tight"},G=["onSubmit"],J={class:"flex flex-col w-full"},K={class:"my-2 flex-auto basis-0"},L={class:"my-2 flex-auto basis-0"},Q=_(" / "),W={class:"my-2 flex-auto basis-0"},X={class:"block font-medium text-sm text-gray-700 mb-1"},Z=_(" / "),tt={key:1,class:"grid grid-cols-2 gep-x-3"},et={class:"relative"},ot=o("p",{class:"absolute top-0 ml-1 text-xxs"},"From:",-1),at={class:"relative"},st=o("p",{class:"absolute top-0 ml-1 text-xxs"},"To:",-1),rt={class:"my-2 flex-auto basis-0"},nt=o("span",{class:"text-red-500"},"*",-1),lt={class:"relative overflow-hidden"},it=["textContent"],dt={class:"col-span-4 flex justify-end mt-5 w-full"},kt={__name:"TimeRecordEdit",props:{timetrack:Object},emits:["saved"],setup(g,{emit:V}){var T,$;const i=g,u=v(i.timetrack.timetrackable_type==="App\\Models\\Contact"?"contact":"project"),m=v("duration"),x=v(),y=v(),f=j(()=>Y().props.value.errors);j(()=>Object.keys(f.value).length>0);const h=()=>{s.put(route("timetrack.update",i.timetrack),{onSuccess:()=>{V("saved"),s.reset()}})},H=r=>String(Math.floor(r/60)).padStart(2,"0")+":"+String(r%60).padStart(2,"0"),M=()=>{var r=moment(x.value,"HH:mm"),t=moment(y.value,"HH:mm"),e=moment.duration(t.diff(r)),D=parseInt(e.asHours())<10?"0"+parseInt(e.asHours()):parseInt(e.asHours()),I=parseInt(e.asMinutes())%60<10?"0"+parseInt(e.asMinutes())%60:parseInt(e.asMinutes())%60;s.duration=D+":"+I,m.value="duration"},s=N({timetrackable_type:(T=i.timetrackable)==null?void 0:T.classname,timetrackable_id:($=i.timetrackable)==null?void 0:$.id,duration:H(i.timetrack.minutes),note:i.timetrack.note,created_at:moment(i.timetrack.started_at).format("YYYY-MM-DDTHH:mm")});return(r,t)=>(b(),F(R,{title:r.__("Edit Timetrack")},{header:d(()=>[o("h2",q,n(r.__("Edit Timetrack")),1)]),default:d(()=>[o("form",{onSubmit:E(h,["prevent"])},[o("div",J,[o("div",K,[l(S,{class:"mb-1"},{default:d(()=>[_(n(r.__("Date")),1)]),_:1}),l(A,{id:"created_at",name:"created_at",modelValue:a(s).created_at,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).created_at=e),type:"datetime-local",class:"border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full"},null,8,["modelValue"])]),o("div",L,[l(S,{class:"mb-1"},{default:d(()=>[o("span",{onClick:t[1]||(t[1]=e=>u.value="contact"),class:c(["underline cursor-pointer",u.value=="contact"?"text-orange-500":""])},n(r.__("Select Customer")),3),Q,o("span",{onClick:t[2]||(t[2]=e=>u.value="project"),class:c(["underline cursor-pointer",u.value=="project"?"text-orange-500":""])},n(r.__("Select Project")),3)]),_:1}),p(l(O,{ref:"contactSelect",contact:g.timetrack.timetrackable,form:a(s),onRemove:t[3]||(t[3]=e=>a(s).contact_id=null),onSet:t[4]||(t[4]=e=>{a(s).timetrackable_type=e.classname,a(s).timetrackable_id=e.id}),address:!1},null,8,["contact","form"]),[[C,u.value==="contact"]]),p(l(P,{ref:"projectSelect",project:g.timetrack.timetrackable,form:a(s),onRemove:t[5]||(t[5]=e=>a(s).contact_id=null),onSet:t[6]||(t[6]=e=>{a(s).timetrackable_type=e.classname,a(s).timetrackable_id=e.id}),address:!1},null,8,["project","form"]),[[C,u.value=="project"]])]),o("div",W,[o("label",X,[o("span",{class:c(["cursor-pointer",m.value=="duration"?"text-orange-500 underline":""]),onClick:t[7]||(t[7]=e=>m.value="duration")},n(r.__("Duration")),3),Z,o("span",{class:c(["cursor-pointer",m.value!="duration"?"text-orange-500 underline":""]),onClick:t[8]||(t[8]=e=>m.value="span")},n(r.__("From - To")),3)]),m.value=="duration"?p((b(),w("input",{key:0,id:"duration",type:"time","onUpdate:modelValue":t[9]||(t[9]=e=>a(s).duration=e),class:"w-full border-gray-300"},null,512)),[[k,a(s).duration]]):(b(),w("div",tt,[o("div",et,[p(o("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":t[10]||(t[10]=e=>x.value=e)},null,512),[[k,x.value]]),ot]),o("div",at,[p(o("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":t[11]||(t[11]=e=>y.value=e),onFocusout:M},null,544),[[k,y.value]]),st])]))]),o("div",rt,[l(S,{for:"note"},{default:d(()=>[_(n(r.__("Note")),1),nt]),_:1}),o("div",lt,[p(o("textarea",{rows:"1",id:"name","onUpdate:modelValue":t[12]||(t[12]=e=>a(s).note=e),class:c(["border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full",a(f).note?"border-2 border-red-500":""]),onFocus:t[13]||(t[13]=e=>delete a(f).note)},null,34),[[k,a(s).note]]),l(B,{name:"error"},{default:d(()=>[a(f).note?(b(),w("p",{key:0,class:"absolute left-0 bottom-0 text-red-600 text-xxs ml-3 line-clamp-1 hover:line-clamp-3",textContent:n(a(f).note)},null,8,it)):U("",!0)]),_:1})])])]),o("div",dt,[l(z,{class:c({"opacity-25":a(s).processing}),disabled:a(s).processing},{default:d(()=>[_(n(r.__("save")),1)]),_:1},8,["class","disabled"])])],40,G)]),_:1},8,["title"]))}};export{kt as default};
