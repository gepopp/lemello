import{d as g,k as V,u as I,o as f,c as N,w as l,a as s,t as n,b as i,i as c,g as o,n as p,x as _,N as v,e as k,f as F,T as U,p as B,l as E}from"./app.902c1631.js";import{_ as Y}from"./AppLayout.1e89a0c4.js";import{_ as y}from"./Label.e87d20e0.js";import{_ as j}from"./ContactSelect.6afe4676.js";import{_ as O}from"./Button.03a0c649.js";import{_ as R}from"./Input.0ba70f7a.js";import"./_plugin-vue_export-helper.cdc0426e.js";const z={class:"font-semibold text-xl text-gray-800 leading-tight"},P=["onSubmit"],q={class:"flex flex-col w-full"},A={class:"my-2 flex-auto basis-0"},G={class:"my-2 flex-auto basis-0"},J={class:"my-2 flex-auto basis-0"},K={class:"block font-medium text-sm text-gray-700 mb-1"},L=c(" / "),Q={key:1,class:"grid grid-cols-2 gep-x-3"},W={class:"relative"},X=s("p",{class:"absolute top-0 ml-1 text-xxs"},"From:",-1),Z={class:"relative"},tt=s("p",{class:"absolute top-0 ml-1 text-xxs"},"To:",-1),et={class:"my-2 flex-auto basis-0"},st=s("span",{class:"text-red-500"},"*",-1),ot={class:"relative overflow-hidden"},at=["textContent"],rt={class:"col-span-4 flex justify-end mt-5 w-full"},ft={__name:"TimeRecordEdit",props:{timetrack:Object},emits:["saved"],setup(w,{emit:S}){var h,T;const d=w,u=g("duration"),b=g(),x=g(),m=V(()=>E().props.value.errors);V(()=>Object.keys(m.value).length>0);const H=()=>{a.put(route("timetrack.update",d.timetrack),{onSuccess:()=>{S("saved"),a.reset()}})},$=r=>String(Math.floor(r/60)).padStart(2,"0")+":"+String(r%60).padStart(2,"0"),C=()=>{var r=moment(b.value,"HH:mm"),t=moment(x.value,"HH:mm"),e=moment.duration(t.diff(r)),D=parseInt(e.asHours())<10?"0"+parseInt(e.asHours()):parseInt(e.asHours()),M=parseInt(e.asMinutes())%60<10?"0"+parseInt(e.asMinutes())%60:parseInt(e.asMinutes())%60;a.duration=D+":"+M,u.value="duration"},a=I({timetrackable_type:(h=d.attach)==null?void 0:h.classname,timetrackable_id:(T=d.attach)==null?void 0:T.id,duration:$(d.timetrack.minutes),note:d.timetrack.note,created_at:moment(d.timetrack.started_at).format("YYYY-MM-DDTHH:mm")});return(r,t)=>(f(),N(Y,{title:r.__("Edit Timetrack")},{header:l(()=>[s("h2",z,n(r.__("Edit Timetrack")),1)]),default:l(()=>[s("form",{onSubmit:B(H,["prevent"])},[s("div",q,[s("div",A,[i(y,{class:"mb-1"},{default:l(()=>[c(n(r.__("Date")),1)]),_:1}),i(R,{id:"created_at",name:"created_at",modelValue:o(a).created_at,"onUpdate:modelValue":t[0]||(t[0]=e=>o(a).created_at=e),type:"datetime-local",class:"border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full"},null,8,["modelValue"])]),s("div",G,[i(y,{class:"mb-1"},{default:l(()=>[c(n(r.__("Select Customer")),1)]),_:1}),i(j,{contact:w.timetrack.timetrackable,form:o(a),onRemove:t[1]||(t[1]=e=>o(a).contact_id=null),onSet:t[2]||(t[2]=e=>o(a).contact_id=e.id),address:!1},null,8,["contact","form"])]),s("div",J,[s("label",K,[s("span",{class:p(["cursor-pointer",u.value=="duration"?"text-orange-500 underline":""]),onClick:t[3]||(t[3]=e=>u.value="duration")},n(r.__("Duration")),3),L,s("span",{class:p(["cursor-pointer",u.value!="duration"?"text-orange-500 underline":""]),onClick:t[4]||(t[4]=e=>u.value="span")},n(r.__("From - To")),3)]),u.value=="duration"?_((f(),k("input",{key:0,id:"duration",type:"time","onUpdate:modelValue":t[5]||(t[5]=e=>o(a).duration=e),class:"w-full border-gray-300"},null,512)),[[v,o(a).duration]]):(f(),k("div",Q,[s("div",W,[_(s("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e)},null,512),[[v,b.value]]),X]),s("div",Z,[_(s("input",{type:"time",class:"w-full border-gray-300","onUpdate:modelValue":t[7]||(t[7]=e=>x.value=e),onFocusout:C},null,544),[[v,x.value]]),tt])]))]),s("div",et,[i(y,{for:"note"},{default:l(()=>[c(n(r.__("Note")),1),st]),_:1}),s("div",ot,[_(s("textarea",{rows:"1",id:"name","onUpdate:modelValue":t[8]||(t[8]=e=>o(a).note=e),class:p(["border-gray-300 focus:border-orange-300 focus:border-2 focus:ring-0 focus:outline-none focus:shadow-none shadow-sm mt-1 block w-full",o(m).note?"border-2 border-red-500":""]),onFocus:t[9]||(t[9]=e=>delete o(m).note)},null,34),[[v,o(a).note]]),i(U,{name:"error"},{default:l(()=>[o(m).note?(f(),k("p",{key:0,class:"absolute left-0 bottom-0 text-red-600 text-xxs ml-3 line-clamp-1 hover:line-clamp-3",textContent:n(o(m).note)},null,8,at)):F("",!0)]),_:1})])])]),s("div",rt,[i(O,{class:p({"opacity-25":o(a).processing}),disabled:o(a).processing},{default:l(()=>[c(n(r.__("save")),1)]),_:1},8,["class","disabled"])])],40,P)]),_:1},8,["title"]))}};export{ft as default};
